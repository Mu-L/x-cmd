
___x_cmd_job_log(){
    local op="$1"
    case "$op" in
        save)       shift; ___x_cmd_job_log_save "$@" ;;
        ls)         shift; ___x_cmd_job_log_ls "$@" ;;
        cat)        shift; ___x_cmd_job_log_cat "$@" ;;
        out)        shift; ___x_cmd_job_log_out "$@" ;;
        err)        shift; ___x_cmd_job_log_err "$@" ;;
    esac
}

___x_cmd_job_log_cat(){     CODE=unpack ___x_cmd_job_log___cat "$@";    }
___x_cmd_job_log_err(){     CODE=err    ___x_cmd_job_log___cat "$@";    }
___x_cmd_job_log_out(){     CODE=out    ___x_cmd_job_log___cat "$@";    }

___x_cmd_job_log___cat(){
    local idx="${1:?Provide job idx}"

    local logfile="${___X_CMD_JOB_OFFER_LOG:-$___X_CMD_LOG_STORE_DEFAULT/job/DEFAULT/$(x pidofsubshell)}/$idx"
    [ -f "$logfile" ] || {
        job:error "logfile NOT found: $logfile"
        return 1
    }
    x outerr "$CODE" <"$logfile"
}

___x_cmd_job_log_ls(){
    local logdir="${___X_CMD_JOB_OFFER_LOG:-$___X_CMD_LOG_STORE_DEFAULT/job/DEFAULT/$(x pidofsubshell)}"
    (
        x mcd "$logdir"
        ls .
    )
}

___x_cmd_job_log_save(){
    local fp="${1:?Provide filepath}"
    local logdir="${___X_CMD_JOB_OFFER_LOG:-$___X_CMD_LOG_STORE_DEFAULT/job/DEFAULT/$(x pidofsubshell)}"

    x cp -r "$logdir" "$fp"
}
