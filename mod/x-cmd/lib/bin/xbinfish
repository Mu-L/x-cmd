#! /bin/sh

___X_CMD_ROOT="${___X_CMD_ROOT:-$HOME/.x-cmd.root}"

___x_cmd_xbinfish___init(){
    case "$0" in
        */mod/x-cmd/lib/bin/xbin)
            ___X_CMD_ROOT_CODE="${0%/mod/x-cmd/lib/bin/xbin}"
            . "$___X_CMD_ROOT_CODE/X"
            ;;
        *)
            # ___X_CMD_ROOT_CODE="$___X_CMD_"
            # echo "error heree $0"
            # return 1
            . "$HOME/.x-cmd.root/X"
            ;;
    esac
}

___x_cmd_xbinfish___init || exit 1

___x_cmd_xbinfish___run(){
    local ___X_CMD_XFISHBIN_PATH="$PATH"
    local ___X_CMD_XFISHBIN_PWD="$PWD"

    local ___X_CMD_XFISHBIN_EXIT=0

    ___x_cmd "$@" || ___X_CMD_XFISHBIN_EXIT=$?

    [ "$___X_CMD_XFISHBIN_PATH" = "$PATH"  ] || printf "%s" "$PATH"   >"$___X_CMD_XFISHBIN_FP/PATH"
    [ "$___X_CMD_XFISHBIN_PWD"  = "$PWD"   ] || printf "%s" "$PWD"    >"$___X_CMD_XFISHBIN_FP/PWD"

    return "$___X_CMD_XFISHBIN_EXIT"
}

___x_cmd_xbinfish___run "$@"


