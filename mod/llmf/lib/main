# shellcheck shell=dash

x log init llmf
xrc:mod:lib     llmf model/_index cli serve nv

! ___x_cmd_is_suitable_advise_env || xrc:mod:lib    llmf advise

___x_cmd_llmf___main(){
    [ "$#" -gt 0 ]      ||   set - nv

    local op="$1";      shift
    case "$op" in
        -h|--help)      x help -m llmf              ;;
        model)          ___x_cmd_llmf_model "$@"    ;;

        serve)          ___x_cmd_llmf_serve "$@"    ;;
        cli)            ___x_cmd_llmf_cli   "$@"    ;;

        nv)             ___x_cmd_llmf_nv    "$@"    ;;

        --)             ___x_cmd_llmf_cli "$@"      ;;
        *)              ___x_cmd_llmf_cli "$op" "$@" ;;
    esac
}

___x_cmd_llmf___llamafile_exec(){
    [ "$#" -gt 0 ]      ||   set - --help
    ___x_cmd cosmo llamafile "$@"
}


___x_cmd_llmf___exec(){
    local model="$1";    shift
    case "$model" in
        *.llamafile)    ___x_cmd cosmo --arun              "$model" "$@" ;;
        *.gguf)         ___x_cmd cosmo llamafile --model   "$model" "$@" ;;
    esac
}
