# shellcheck shell=bash
___x_cmd_shodan_notifier_ls(){
    shodan:info "Get a list of all the notifiers that the user has created"

    if  ! ___x_cmd_shodan_is_interactive_env; then
        ___x_cmd_shodan_notifier_ls___curl
        return
    fi

    local data
    data=$(___x_cmd_shodan_notifier_ls___csv | x csv --app --return print) || return

    [ -n "$data" ] || return

    local notifier_id=${data%%,*}

    local id=3
    x ui select id "Next move for notifer id=${notifier_id}"  \
        "info"      \
        "remove"    \
        "Abort"

    case "$id" in
        1)  ___x_cmd_shodan_notifier_info       "$notifier_id" ;;
        2)  ___x_cmd_shodan_notifier_remove     "$notifier_id" ;;
        3)  return 0 ;;
    esac
}

___x_cmd_shodan_notifier_ll(){
    shodan:info "Get a list of all the notifiers that the user has created"

    ___x_cmd_shodan_notifier_ls___csv | x csv static_tab
}

___x_cmd_shodan_notifier_ls___curl(){
    X_CCMD_TIMEOUT=5s ___x_cmd_shodan_curl get "/notifier"
}

___x_cmd_shodan_notifier_ls___csv(){
    ___x_cmd_shodan_notifier_ls___curl | x jo .matches.\* |\
        x ja jl2c  .id .provider .description .args |\
        x csv header --add  ID  Provider Description Args
}
