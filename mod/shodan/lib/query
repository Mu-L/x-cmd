# shellcheck shell=dash
___x_cmd_shodan_query(){
    [ $# -gt 0 ]    ||      set - ls
    local op="$1";  shift
    case "$op" in
        ls|ll|search|tag)
            ___x_cmd_shodan_query_"$op" "$@"
    esac
}

___x_cmd_shodan_query_ls(){
    shodan:info "Obtain a list of search queries that users have saved in Shodan"

   if   ___x_cmd_shodan_is_interactive_env; then
        ___x_cmd_shodan_curl get "/shodan/query?" | x jo . .matches |\
        x ja 2c .title .votes .query .description .timestamp |\
        x csv header --add  Title Votes query Description Timestamp | \
        x csv app --width "10%,-,-,-,-"
    else
        ___x_cmd_shodan_curl get "/shodan/query?"
    fi
}

___x_cmd_shodan_query_ll(){
    shodan:info "obtain a list of search queries that users have saved in Shodan"

    ___x_cmd_shodan_curl get "/shodan/query?" | x jo . .matches |\
        x ja 2c .title .votes .query .description .timestamp  |\
        x csv header --add  Title Votes query Description Timestamp  | \
        x csv static_tab
}

___x_cmd_shodan_query_search(){
    if  ___x_cmd_shodan_is_interactive_env; then
        ___x_cmd_shodan_curl get "/shodan/query/search?" | x j2y
    else
        ___x_cmd_shodan_curl get "/shodan/query/search?"
    fi
}

___x_cmd_shodan_query_tag(){
    if  ___x_cmd_shodan_is_interactive_env; then ___x_cmd_shodan_curl get "/shodan/query/tags?" | x j2y
    else                                         ___x_cmd_shodan_curl get "/shodan/query/tags?"
    fi
}


