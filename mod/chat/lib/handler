# shellcheck shell=dash

___x_cmd_chat_handler___stream_to_print(){
    x cawk -m j/json,j/jiter \
        -f "$___X_CMD_ROOT_MOD/chat/lib/awk/stream_to_print.awk"
}

___x_cmd_chat_handler___get_history_record(){
    local dir="$1"
    local history="$2"
    [ -d "$dir" ] || return

    # TODO: use yml y2j
    x fsiter "$dir" | sort -r | x arg1 '< "$dir/$1" x y2j' 2>/dev/null | \
        history="$history" x cawk -m j/json,j/jiter \
        -f "$___X_CMD_ROOT_MOD/chat/lib/awk/get_history_record.awk"
}
